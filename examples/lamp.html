<html>
<head>
  <meta charset="utf-8">

  <script src="../src/jquery-3.6.0.min.js"></script>
  <script src="../src/crypto/wasm_exec.js"></script>
  <script src="../src/crypto/crypto.js"></script>
  <script src="../src/colonyruntime.js"></script>

</head>
<body>
  <img id="lamp" src="./lamp_off.png">
  <script>
    $(function() {
      let colonyid = "bdebcd2a6069cab6d1cee1e081780e02ec16d9e9f15bbb84906731a5ca541592"
      let runtimeid = "6af2c7593d2760b6c81f145828158dae2a9648cbb29061d95fe54f55f69c2e24"
      let runtime_prvkey = "3e0868011b52c55457df9bbccd37ce8fb99ad88318094243123e462aa341bd51"
      let runtime = new ColonyRuntime()
// ci"
      runtime.load()
      .then(() => {
        runtime.subscribe_processes("lamp", 0, runtime_prvkey, function(processes) {
          runtime.assign(colonyid, runtime_prvkey).then((process, err) => {
            lamp_state = process.attributes[0].value
            if (lamp_state == "on") {
              $("#lamp").attr("src","./lamp_on.png");
            }
            if (lamp_state == "off") {
              $("#lamp").attr("src","./lamp_off.png");
            }

            runtime.close_process(process.processid, true, runtime_prvkey)
          }) 
        })
      });
    });
  </script>
</body>
</html>
